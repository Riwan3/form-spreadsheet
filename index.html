<!DOCTYPE html>
<html>
  <head>
    <meta charset="UTF-8" />
    <title>Form ke Google Sheet</title>
  </head>
  <body>
    <h2>Form Masuk Spreadsheet</h2>
    <form id="myForm">
      <input type="text" name="nama" placeholder="Nama" required /><br /><br />
      <input
        type="email"
        name="email"
        placeholder="Email"
        required
      /><br /><br />
      <textarea name="pesan" placeholder="Pesan" required></textarea
      ><br /><br />
      <button type="submit">Kirim</button>
    </form>

    <script>
      document
        .getElementById("myForm")
        .addEventListener("submit", async (e) => {
          e.preventDefault();
          const data = Object.fromEntries(new FormData(e.target).entries());
          const response = await fetch(
            "https://script.google.com/macros/s/AKfycbxyU42TQnD62k5RFB5zRyG5tvx1ya-31XStA2Iwym4eTwGWPmHlhtKE9Dw4W4E-M8iT8A/exec",
            {
              method: "POST",
              body: JSON.stringify(data),
              headers: { "Content-Type": "application/json" },
            }
          );
          alert(await response.text());
          e.target.reset();
        });
    </script>
  </body>
</html>
